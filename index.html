<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <!-- Mobile responsiveness -->
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Generate Birth Chart Free</title>
  <meta name="description" content="Generate Birth Chart Free: Create your personalized Loshu grid numerology chart and compute your Driver, Conductor, Kuva, and Name Number using your name, birth date, and gender.">
  <meta name="keywords" content="Birth Chart, Loshu Grid, Numerology, Driver, Conductor, Kuva, Name Number, Free Birth Chart">
  <meta name="author" content="Rohit Patel, Ahmedabad">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-PHR4KPGYPV"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-PHR4KPGYPV');
  </script>
  <style>
    html {
  scroll-behavior: smooth;
}
.highlight-section {
  animation: highlightFlash 2s ease-in-out;
}

@keyframes highlightFlash {
  0%   { background-color: #fff3cd; }
  50%  { background-color: #ffeeba; }
  100% { background-color: transparent; }
}

    body {
      background-color: #f8f9fa;
    }
    label.form-label {
      font-weight: 500 !important;
    }
    .card {
      border-radius: 10px;
      border: 1px solid #dee2e6;
    }
    .loshu-grid {
      display: grid;
      grid-template-columns: repeat(3, 80px);
      grid-template-rows: repeat(3, 80px);
      gap: 10px;
      justify-content: center;
      margin-top: 20px;
    }
    .loshu-cell {
      background-color: #ffffff;
      border: 2px solid #ced4da;
      border-radius: 5px;
      text-align: center;
      vertical-align: middle;
      font-size: 20px;
      line-height: 80px;
      color: #212529;
      cursor: pointer;
      position: relative;
    }
    @media (max-width: 576px) {
      .loshu-grid {
        grid-template-columns: repeat(3, 60px);
        grid-template-rows: repeat(3, 60px);
      }
      .loshu-cell {
        font-size: 16px;
        line-height: 60px;
      }
    }
    .readonly-table {
      margin-top: 20px;
      background-color: #fff;
      border: 1px solid #dee2e6;
      border-radius: 5px;
      padding: 10px;
    }
    .description {
      background: #fff;
      padding: 15px;
      margin-bottom: 15px;
      border-radius: 5px;
      border: 1px solid #ddd;
    }
    .number {
      font-weight: bold;
    }
    .loshu-cell:hover {
  background-color: #e9f5ff;
  border-color: #0d6efd;
  transition: 0.2s ease;
  box-shadow: 0 0 5px rgba(13, 110, 253, 0.5);
}
  </style>
</head>
<body> 
<div class="container py-4">
  <!-- Main Card for Birth Chart Form and Grid -->
  <div class="card mx-auto p-4" style="max-width: 900px;">
    <h2 class="text-center mb-4">Generate Birth Chart Free</h2>
    <div class="text-center mb-3">
      <a href="#historyContainer" class="btn btn-outline-secondary btn-sm" style="font-size: 11px;">тмЗ View Search History</a>
    </div>
    <form id="birthForm" class="row g-3">
      <!-- Name input -->
      <div class="col-12">
        <label for="name" class="form-label">Name (First + Last)</label>
        <input type="text" id="name" class="form-control" required placeholder="e.g. Rohit Patel">
      </div>
      <!-- Day dropdown -->
      <div class="col-4">
        <label for="day" class="form-label">Day</label>
        <select id="day" class="form-select" required>
          <option value="">--</option>
          <option>1</option><option>2</option><option>3</option>
          <option>4</option><option>5</option><option>6</option>
          <option>7</option><option>8</option><option>9</option>
          <option>10</option><option>11</option><option>12</option>
          <option>13</option><option>14</option><option>15</option>
          <option>16</option><option>17</option><option>18</option>
          <option>19</option><option>20</option><option>21</option>
          <option>22</option><option>23</option><option>24</option>
          <option>25</option><option>26</option><option>27</option>
          <option>28</option><option>29</option><option>30</option>
          <option>31</option>
        </select>
      </div>
      <!-- Month dropdown -->
      <div class="col-4">
        <label for="month" class="form-label">Month</label>
        <select id="month" class="form-select" required>
          <option value="">--</option>
          <option value="1">January</option>
          <option value="2">February</option>
          <option value="3">March</option>
          <option value="4">April</option>
          <option value="5">May</option>
          <option value="6">June</option>
          <option value="7">July</option>
          <option value="8">August</option>
          <option value="9">September</option>
          <option value="10">October</option>
          <option value="11">November</option>
          <option value="12">December</option>
        </select>
      </div>
      <!-- Year dropdown -->
      <div class="col-4">
        <label for="year" class="form-label">Year</label>
        <select id="year" class="form-select" required>
          <option value="">--</option>
        </select>
      </div>
      <!-- Gender selection -->
      <div class="col-12">
        <label class="form-label">Gender</label><br>
        <div class="form-check form-check-inline">
          <input class="form-check-input" type="radio" name="gender" id="male" value="male" required>
          <label class="form-check-label" for="male">Male</label>
        </div>
        <div class="form-check form-check-inline">
          <input class="form-check-input" type="radio" name="gender" id="female" value="female" required>
          <label class="form-check-label" for="female">Female</label>
        </div>
      </div>
      <div class="col-12">
        <button type="submit" class="btn btn-primary w-100">Generate Lo Shu Grid</button>
      </div>
    </form>
    
    <!-- Loshu Grid (rendered dynamically) -->
    <div class="loshu-grid" id="loshuGrid"></div>
    
    <!-- Computed Values Row -->
    <div class="row text-center mt-3">
      <div class="col">
        <strong>Personality:</strong> <span id="driverLabel"></span>
      </div>
      <div class="col">
        <strong>Destiny:</strong> <span id="conductorLabel"></span>
      </div>
      <div class="col">
        <strong>Kua:</strong> <span id="kuvaLabel"></span>
      </div> 
    </div>
    <!-- Name Number Row -->
    <div class="row text-center mt-3">
      <div class="col">
        <strong>Name Number:</strong> <span id="nameNumberLabel"></span>
      </div>
    </div>
  </div>
  
  <!-- Accordion for Numerology Descriptions and Mapping -->
  <div class="card mx-auto p-4 readonly-table " style="max-width: 900px; margin-top: 20px;">
    <div class="accordion" id="accordionExample"> 
    
      <!-- Numerology Descriptions Accordion Item with Tooltips -->
      <div class="accordion-item">
        <h2 class="accordion-header" id="headingGridNumbers">
          <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseGridNumbers" aria-expanded="false" aria-controls="collapseGridNumbers">
            Lo Shu Grid Numbers: Predictions, Planes & Arrows (1тАУ9)
          </button>
        </h2>
        <div id="collapseGridNumbers" class="accordion-collapse collapse" aria-labelledby="headingGridNumbers" data-bs-parent="#accordionExample">
          <div class="accordion-body" style="max-height: 600px; overflow-y: auto;">
      
            <h5>Characteristics & Predictions (1тАУ9)</h5>
            <ul class="list-unstyled">
              <li><strong>1:</strong> Leader, confident, idea-starter. <em>Likely to achieve big dreams and take charge.</em></li>
              <li><strong>2:</strong> Kind, team player, nurturing. <em>Brings harmony and success in relationships.</em></li>
              <li><strong>3:</strong> Creative, joyful, expressive. <em>Positive and opens doors to exciting opportunities.</em></li>
              <li><strong>4:</strong> Practical, reliable, disciplined. <em>Great for planning, order, and structured success.</em></li>
              <li><strong>5:</strong> Adventurous, flexible, freedom-loving. <em>Seeks variety, open to change and personal growth.</em></li>
              <li><strong>6:</strong> Responsible, caring, family-oriented. <em>Strong provider and community supporter.</em></li>
              <li><strong>7:</strong> Wise, introspective, spiritual. <em>Seeks truth and deeper meaning in life.</em></li>
              <li><strong>8:</strong> Ambitious, focused, leadership skills. <em>Aims for wealth and authority.</em></li>
              <li><strong>9:</strong> Compassionate, idealistic, energetic. <em>Drives change through kindness and service.</em></li>
            </ul>
      
            <hr>
      
            <h5>Key Benefits of the Lo Shu Grid Calculator</h5>
            <ul>
              <li>Reveals hidden personality traits and strengths.</li>
              <li>Identifies challenges and career opportunities.</li>
              <li>Provides compatibility and relationship insights.</li>
              <li>Guides personal growth and energy balancing.</li>
              <li>Highlights missing numbers and their remedies.</li>
              <li>Quick and easy tool for personalized numerology.</li>
            </ul>
      
            <hr>
      
            <h5>Planes in the Lo Shu Grid</h5>
            <p>The Lo Shu Grid includes rows, columns, and diagonals called <strong>planes</strong>. Each plane reflects a different aspect of your personality:</p>
            <ul>
              <li><strong>Diagonal:</strong> 2-5-8 (Silver Yog), 4-5-6 (Golden Yog)</li>
              <li><strong>Vertical:</strong> 4-3-8 (Thought), 9-5-1 (Will), 2-7-6 (Action)</li>
              <li><strong>Horizontal:</strong> 4-9-2 (Mind), 3-5-7 (Emotional), 8-1-6 (Practical)</li>
            </ul>
      
            <hr>
      
            <h5>Present Arrows in Lo Shu Grid</h5>
            <ul>
              <li><strong>2-5-8:</strong> Strong willpower, great under pressure, real estate potential.</li>
              <li><strong>4-5-6:</strong> Positive energy, gentle, respectful, grows into a strong personality.</li>
              <li><strong>4-9-2:</strong> Sharp memory, logical, excellent planner, honest.</li>
              <li><strong>3-5-7:</strong> Emotionally wise, kind-hearted, spiritually inclined.</li>
              <li><strong>8-1-6:</strong> Very practical, business-savvy, financially focused.</li>
              <li><strong>4-3-8:</strong> Strategic thinker, clear vision, goal-oriented.</li>
              <li><strong>9-5-1:</strong> Strong-willed, passionate, assertive in communication.</li>
              <li><strong>2-7-6:</strong> Active, physically energetic, completes tasks well.</li>
            </ul>
      
            <hr>
      
            <h5>Missing Arrows and Their Effects</h5>
            <ul>
              <li><strong>2-5-8:</strong> Prone to mistakes; needs to pause and think before acting.</li>
              <li><strong>4-5-6:</strong> Struggles with self-doubt and fear of failure.</li>
              <li><strong>4-9-2:</strong> Weak memory, especially later in life.</li>
              <li><strong>3-5-7:</strong> Feels lonely even in crowds; lacks inner motivation.</li>
              <li><strong>8-1-6:</strong> Dreams of success without effort; lacks practicality.</li>
              <li><strong>4-3-8:</strong> Confused thinking, poor decision-making.</li>
              <li><strong>9-5-1:</strong> Easily influenced, lacks firm decisions, approval-seeking.</li>
              <li><strong>2-7-6:</strong> Misses opportunities due to hesitation and fear of risk.</li>
            </ul>
      
            <p class="mt-3"><em>The Lo Shu Grid is like a mirror of your inner worldтАФuse it to discover your strengths, balance your life, and unlock your full potential!</em></p>
          </div>
        </div>
      </div>
      
      
      <!-- Alphabet to Planet Mapping Accordion Item -->
      <div class="accordion-item">
        <h2 class="accordion-header" id="headingMapping">
          <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseMapping" aria-expanded="false" aria-controls="collapseMapping">
            Alphabet to Planet Mapping 
          </button>
        </h2>
        <div id="collapseMapping" class="accordion-collapse collapse" aria-labelledby="headingMapping" data-bs-parent="#accordionExample">
          <div class="accordion-body">
            <table class="table table-bordered">
              <thead>
                <tr>
                  <th><strong>ALPHABETS</strong></th>
                  <th><strong>NUMBER</strong></th>
                  <th><strong>PLANETS</strong></th>
                </tr>
              </thead>
              <tbody>
                <tr><td>A I J Q Y</td><td>1</td><td>SUN - рк╕рлВрк░рлНркп</td></tr>
                <tr><td>B K R</td><td>2</td><td>MOON - ркЪркВркжрлНрк░</td></tr>
                <tr><td>C G L S</td><td>3</td><td>JUPITER - ркЧрлБрк░рлБ</td></tr>
                <tr><td>D M T</td><td>4</td><td>RAHU - рк░рк╛рк╣рлБ</td></tr>
                <tr><td>E H N X</td><td>5</td><td>MERCURY - ркмрлБркз</td></tr>
                <tr><td>U V W</td><td>6</td><td>VENUS - рк╢рлБркХрлНрк░</td></tr>
                <tr><td>O Z</td><td>7</td><td>KETU - ркХрлЗрддреБ</td></tr>
                <tr><td>F P</td><td>8</td><td>SATURN - рк╢ркирк┐</td></tr>
                <tr><td></td><td>9</td><td>MARS - ркоркВркЧрк│</td></tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>

    </div>
  </div>
  
  <!-- Search History Section -->
  <div class="card mx-auto p-4 readonly-table" style="max-width: 900px; margin-top: 20px;" id="historyContainer">
    <h4 class="text-center">Search History</h4>
    <div id="historyList"></div>
  </div>
  
</div>
<div class="modal fade" id="detailModal" tabindex="-1" aria-labelledby="detailModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
         <h5 class="modal-title" id="detailModalLabel"></h5>
         <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body" id="detailModalBody">
         <!-- Description will be inserted here -->
      </div>
    </div>
  </div>
</div>


<!-- Bootstrap 5 Bundle JS (includes Popper) -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script>
  // Initialize Bootstrap tooltips (trigger on hover, focus, click)
  document.addEventListener('DOMContentLoaded', function () {
    initTolltip();
  });
  function initTolltip(){
    const tooltipTriggerList = Array.from(document.querySelectorAll('[data-bs-toggle="tooltip"]'));
    tooltipTriggerList.forEach(tooltipTriggerEl => {
      new bootstrap.Tooltip(tooltipTriggerEl);
    });

  }

  // Populate year dropdown dynamically from (currentYear - 100) to currentYear
  document.addEventListener("DOMContentLoaded", function() {
    const yearSelect = document.getElementById("year");
    const currentYear = new Date().getFullYear();
    const startYear = currentYear - 100;
    for (let y = currentYear; y >= startYear; y--) {
      const opt = document.createElement("option");
      opt.value = y;
      opt.textContent = y;
      yearSelect.appendChild(opt);
    }
    renderHistory(); // Render history on page load
  });
  
  // Compute digital root (reduce to single digit)
  function digitalRoot(n) {
    n = parseInt(n, 10);
    while (n > 9) {
      n = String(n).split('').reduce((sum, digit) => sum + parseInt(digit, 10), 0);
    }
    return n;
  }
  
  // Compute Name Number from the provided name using the mapping:
  // A, I, J, Q, Y => 1; B, K, R => 2; C, G, L, S => 3; D, M, T => 4;
  // E, H, N, X => 5; U, V, W => 6; O, Z => 7; F, P => 8.
  function computeNameNumber(name) {
    name = name.toUpperCase();
    let sum = 0;
    for (let char of name) {
      if (char >= 'A' && char <= 'Z') {
        if ("AIJQY".includes(char)) {
          sum += 1;
        } else if ("BKR".includes(char)) {
          sum += 2;
        } else if ("CGLS".includes(char)) {
          sum += 3;
        } else if ("DMT".includes(char)) {
          sum += 4;
        } else if ("EHNX".includes(char)) {
          sum += 5;
        } else if ("UVW".includes(char)) {
          sum += 6;
        } else if ("OZ".includes(char)) {
          sum += 7;
        } else if ("FP".includes(char)) {
          sum += 8;
        }
      }
    }
    return digitalRoot(sum);
  }
  
  // Loshu Grid mapping (standard positions):
  //      4   9   2
  //      3   5   7
  //      8   1   6
  const positionMap = {
    1: [2, 1],
    2: [0, 2],
    3: [1, 0],
    4: [0, 0],
    5: [1, 1],
    6: [2, 2],
    7: [1, 2],
    8: [2, 0],
    9: [0, 1]
  };
  
  const birthForm = document.getElementById('birthForm');
  const loshuGridDiv = document.getElementById('loshuGrid');
  const driverLabel = document.getElementById('driverLabel');
  const conductorLabel = document.getElementById('conductorLabel');
  const kuvaLabel = document.getElementById('kuvaLabel');
  const nameNumberLabel = document.getElementById('nameNumberLabel');
  const historyListDiv = document.getElementById('historyList');

  function showPopup(expectedDigit) {
  // Define detailed descriptions for each expected digit
const descriptions = {
  1: `1 (Sun - рк╕рлВрк░рлНркп)<br>1 represents career, success, business, communication, and being yourself. ItтАЩs linked to the water element, kidneys and ears, colors black and dark blue, the Sun, and the middle son. Points north and is good for career.<br><br>рлз (рк╕рлВрк░рлНркп) ркХрк╛рк░ркХрк┐рк░рлНркжрлА, рк╕рклрк│ркдрк╛, рк╡рлНркпрк╡рк╕рк╛ркп, рк╕ркВркЪрк╛рк░ ркЕркирлЗ рккрлЛркдрк╛ркирлА ркЬрк╛ркд ркдрк░рлАркХрлЗ ркЬрлАрк╡рк╡рк╛ркирлБркВ ркжрк░рлНрк╢рк╛рк╡рлЗ ркЫрлЗ. ркдрлЗ ркЬрк│ ркдркдрлНрк╡, ркЧрлБрк░рлНркжрк╛ ркЕркирлЗ ркХрк╛рки, ркХрк╛рк│рк╛ ркЕркирлЗ ркЧрк╛ркв рк╡рк╛ркжрк│рлА рк░ркВркЧрлЛ, рк╕рлВрк░рлНркп ркЕркирлЗ ркоркзрлНркпрко рккрлБркдрлНрк░ рк╕рк╛ркерлЗ рк╕ркВркмркВркзрк┐ркд ркЫрлЗ. ркЙркдрлНркдрк░ ркжрк┐рк╢рк╛ркорк╛ркВ ркЫрлЗ ркЕркирлЗ ркХрк╛рк░ркХрк┐рк░рлНркжрлА ркорк╛ркЯрлЗ рк╢рлБркн ркЫрлЗ.`,
  2: `2 (Moon - ркЪркВркжрлНрк░)<br>2 stands for love, marriage, relationships, emotions, and motherly care. ItтАЩs connected to the earth element, abdomen, and the colors pink, red, and white, representing the Moon, the mother, and the southwest direction.<br><br>рли (ркЪркВркжрлНрк░) рккрлНрк░рлЗрко, рк▓ркЧрлНрки, рк╕ркВркмркВркзрлЛ, ркнрк╛рк╡ркирк╛ркУ ркЕркирлЗ ркорк╛ркдрлГркдрлНрк╡ркирлА ркжрлЗркЦрк░рлЗркЦркирлБркВ рккрлНрк░ркдрк┐ркирк┐ркзрк┐ркдрлНрк╡ ркХрк░рлЗ ркЫрлЗ. ркдрлЗ рккрлГркерлНрк╡рлА ркдркдрлНрк╡, рккрлЗркЯ ркЕркирлЗ ркЧрлБрк▓рк╛ркмрлА, рк▓рк╛рк▓ ркЕркирлЗ рк╕рклрлЗркж рк░ркВркЧрлЛ рк╕рк╛ркерлЗ ркЬрлЛркбрк╛ркпрлЗрк▓рлБркВ ркЫрлЗ. ркЪркВркжрлНрк░, ркорк╛ркдрк╛ ркЕркирлЗ ркжркХрлНрк╖рк┐ркг рккрк╢рлНркЪрк┐рко ркжрк┐рк╢рк╛ркирлЗ ркжрк░рлНрк╢рк╛рк╡рлЗ ркЫрлЗ.`,
  3: `3 (Jupiter - ркЧрлБрк░рлБ)<br>3 is about health, planning, imagination, family, and wisdom. ItтАЩs tied to hard wood, feet, knees, and ankles, and is associated with green and blue colors, Jupiter, the oldest son, and the east.<br><br>рлй (ркЧрлБрк░рлБ) ркЖрк░рлЛркЧрлНркп, ркпрлЛркЬркирк╛, ркХрк▓рлНрккркирк╛, рккрк░рк┐рк╡рк╛рк░ ркЕркирлЗ ркЬрлНркЮрк╛рки ркорк╛ркЯрлЗ ркЫрлЗ. ркдрлЗ ркХркаркг рк▓рк╛ркХркбрлБркВ, рккркЧ, ркШрлВркВркЯркг ркЕркирлЗ рккркЧркирлА ркХрк╛ркВрк╕рк│рлА рк╕рк╛ркерлЗ ркЬрлЛркбрк╛ркпрлЗрк▓рлБркВ ркЫрлЗ. рк▓рлАрк▓рк╛ ркЕркирлЗ рк╡рк╛ркжрк│рлА рк░ркВркЧрлЛ, ркЧрлБрк░рлБ, ркорлЛркЯрлЛ рккрлБркдрлНрк░ ркЕркирлЗ рккрлВрк░рлНрк╡ ркжрк┐рк╢рк╛ рк╕рк╛ркерлЗ рк╕ркВркХрк│рк╛ркпрлЗрк▓рлБркВ ркЫрлЗ.`,
  4: `4 (Rahu - рк░рк╛рк╣рлБ)<br>4 relates to money, discipline, confidence, and power. ItтАЩs linked to soft wood, the liver, and the thicker parts of the body, representing Rahu and associated with the southeast.<br><br>рлк (рк░рк╛рк╣рлБ) рккрлИрк╕рк╛, ркЕркирлБрк╢рк╛рк╕рки, ркЖркдрлНркорк╡рк┐рк╢рлНрк╡рк╛рк╕ ркЕркирлЗ рк╢ркХрлНркдрк┐ рк╕рк╛ркерлЗ рк╕ркВркмркВркзрк┐ркд ркЫрлЗ. ркдрлЗ ркирк░рко рк▓рк╛ркХркбрлБркВ, ркпркХрлГркд ркЕркирлЗ рк╢рк░рлАрк░ркирк╛ ркЬрк╛ркбрк╛ ркнрк╛ркЧрлЛ рк╕рк╛ркерлЗ ркЬрлЛркбрк╛ркпрлЗрк▓рлБркВ ркЫрлЗ. рк░рк╛рк╣рлБркирлБркВ рккрлНрк░ркдрк┐ркирк┐ркзрк┐ркдрлНрк╡ ркХрк░рлЗ ркЫрлЗ ркЕркирлЗ ркжркХрлНрк╖рк┐ркг рккрлВрк░рлНрк╡ ркжрк┐рк╢рк╛ рк╕рк╛ркерлЗ рк╕ркВркХрк│рк╛ркпрлЗрк▓рлБркВ ркЫрлЗ.`,
  5: `5 (Mercury - ркмрлБркз)<br>5 is for balance, stability, fortune, freedom, and mental health. ItтАЩs connected to the earth element, internal organs, and is linked with Mercury, representing the whole family and the center.<br><br>рлл (ркмрлБркз) рк╕ркВркдрлБрк▓рки, рк╕рлНркерк┐рк░ркдрк╛, ркирк╕рлАркм, рк╕рлНрк╡ркдркВркдрлНрк░ркдрк╛ ркЕркирлЗ ркорк╛ркирк╕рк┐ркХ ркЖрк░рлЛркЧрлНркп ркорк╛ркЯрлЗ ркЫрлЗ. ркдрлЗ рккрлГркерлНрк╡рлА ркдркдрлНрк╡ ркЕркирлЗ ркЖркВркдрк░рк┐ркХ ркЕркВркЧрлЛ рк╕рк╛ркерлЗ ркЬрлЛркбрк╛ркпрлЗрк▓рлБркВ ркЫрлЗ. ркмрлБркз, ркЖркЦрк╛ рккрк░рк┐рк╡рк╛рк░ ркЕркирлЗ ркХрлЗркирлНркжрлНрк░ркирлБркВ рккрлНрк░ркдрк┐ркирк┐ркзрк┐ркдрлНрк╡ ркХрк░рлЗ ркЫрлЗ.`,
  6: `6 (Venus - рк╢рлБркХрлНрк░)<br>6 represents friends, travel, new beginnings, and spirituality. ItтАЩs tied to hard metal, the head, and associated with gray, black, and white colors, as well as Venus, the father, and the northwest.<br><br>рлм (рк╢рлБркХрлНрк░) ркорк┐ркдрлНрк░рлЛ, ркорлБрк╕рк╛рклрк░рлА, ркирк╡рк╛ рк╢рк░рлВркЖркд ркЕркирлЗ ркЖркзрлНркпрк╛ркдрлНркорк┐ркХркдрк╛ркирлБркВ рккрлНрк░ркдрк┐ркирк┐ркзрк┐ркдрлНрк╡ ркХрк░рлЗ ркЫрлЗ. ркдрлЗ ркХркаркг ркзрк╛ркдрлБ, ркорк╛ркерлБркВ ркЕркирлЗ ркнрлВркЦрк╛, ркХрк╛рк│рк╛ ркЕркирлЗ рк╕рклрлЗркж рк░ркВркЧрлЛ рк╕рк╛ркерлЗ ркЬрлЛркбрк╛ркпрлЗрк▓рлБркВ ркЫрлЗ. рк╢рлБркХрлНрк░, рккрк┐ркдрк╛ ркЕркирлЗ ркЙркдрлНркдрк░ рккрк╢рлНркЪрк┐рко ркжрк┐рк╢рк╛ркирлЗ ркжрк░рлНрк╢рк╛рк╡рлЗ ркЫрлЗ.`,
  7: `7 (Ketu - ркХрлЗркдрлБ)<br>7 focuses on children, creativity, fun, and the future. ItтАЩs linked to soft metal, the mouth and lungs, and is associated with white, silver, gray, and copper, representing the youngest daughter and the west.<br><br>рлн (рдХреЗрддрлБ) ркмрк╛рк│ркХрлЛ, рк╕рк░рлНркЬркирк╛ркдрлНркоркХркдрк╛, ркЖркиркВркж ркЕркирлЗ ркнрк╡рк┐рк╖рлНркп рккрк░ ркзрлНркпрк╛рки ркХрлЗркирлНркжрлНрк░рк┐ркд ркХрк░рлЗ ркЫрлЗ. ркдрлЗ ркирк░рко ркзрк╛ркдрлБ, ркорлЛркврлБркВ ркЕркирлЗ рклрлЗрклрк╕рк╛ркВ рк╕рк╛ркерлЗ ркЬрлЛркбрк╛ркпрлЗрк▓рлБркВ ркЫрлЗ. рк╕рклрлЗркж, ркЪрк╛ркВркжрлА, ркнрлВркЦрк╛ ркЕркирлЗ ркдрк╛ркорлНрк░ рк░ркВркЧрлЛ рк╕рк╛ркерлЗ рк╕ркВркХрк│рк╛ркпрлЗрк▓рлБркВ ркЫрлЗ. ркирк╛ркирлА ркжрлАркХрк░рлА ркЕркирлЗ рккрк╢рлНркЪрк┐рко ркжрк┐рк╢рк╛ркирлБркВ рккрлНрк░ркдрк┐ркирк┐ркзрк┐ркдрлНрк╡ ркХрк░рлЗ ркЫрлЗ.`,
  8: `8 (Saturn - рк╢ркирк┐)<br>8 symbolizes knowledge, motivation, being organized, and spiritual growth. ItтАЩs related to the earth, hands, body weight, and is tied to blue, black, and green colors, representing Saturn, the youngest son, and the northeast.<br><br>рло (рк╢ркирк┐) ркЬрлНркЮрк╛рки, рккрлНрк░рлЗрк░ркгрк╛, рк╡рлНркпрк╡рк╕рлНркерк┐ркд рк╣рлЛрк╡рлБркВ ркЕркирлЗ ркЖркзрлНркпрк╛ркдрлНркорк┐ркХ рк╡рлГркжрлНркзрк┐ркирлБркВ рккрлНрк░ркдрлАркХ ркЫрлЗ. ркдрлЗ рккрлГркерлНрк╡рлА, рк╣рк╛рке, рк╢рк░рлАрк░ркирк╛ рк╡ркЬрки рк╕рк╛ркерлЗ рк╕ркВркмркВркзрк┐ркд ркЫрлЗ. рк╡рк╛ркжрк│рлА, ркХрк╛рк│рлЛ ркЕркирлЗ рк▓рлАрк▓рлЛ рк░ркВркЧ рк╢ркирк┐, ркирк╛ркирлЛ рккрлБркдрлНрк░ ркЕркирлЗ ркЙркдрлНркдрк░ рккрлВрк░рлНрк╡ ркжрк┐рк╢рк╛ркирлЗ ркжрк░рлНрк╢рк╛рк╡рлЗ ркЫрлЗ.`,
  9: `9 (Mars - ркоркВркЧрк│)<br>9 stands for fame, reputation, social life, and kindness. ItтАЩs associated with fire, the heart, blood, and eyes, linked to the red color, Mars, the middle daughter, and the south.<br><br>рлп (ркоркВркЧрк│) ркпрк╢, рккрлНрк░ркдрк┐рк╖рлНркарк╛, рк╕рк╛ркорк╛ркЬрк┐ркХ ркЬрлАрк╡рки ркЕркирлЗ ркжркпрк╛рк│рлБркдрк╛ркирлБркВ рккрлНрк░ркдрк┐ркирк┐ркзрк┐ркдрлНрк╡ ркХрк░рлЗ ркЫрлЗ. ркдрлЗ ркЕркЧрлНркирк┐, рк╣рлНрк░ркжркп, рк▓рлЛрк╣рлА ркЕркирлЗ ркЖркВркЦрлЛ рк╕рк╛ркерлЗ рк╕ркВркХрк│рк╛ркпрлЗрк▓рлБркВ ркЫрлЗ. рк▓рк╛рк▓ рк░ркВркЧ, ркоркВркЧрк│, ркоркзрлНркпрко ркжрлАркХрк░рлА ркЕркирлЗ ркжркХрлНрк╖рк┐ркг ркжрк┐рк╢рк╛ркирлБркВ рккрлНрк░ркдрлАркХ ркЫрлЗ.`
};


  // Set modal title and body content based on expectedDigit
  document.getElementById("detailModalLabel").innerHTML = `Details for ${expectedDigit}`;
  document.getElementById("detailModalBody").innerHTML = descriptions[expectedDigit] || "No description available.";

  // Show the modal using Bootstrap's Modal API
  const modalElement = document.getElementById("detailModal");
  const modal = new bootstrap.Modal(modalElement);
  modal.show();
}

  // LocalStorage helpers
  function loadHistory() {
    const history = localStorage.getItem('birthChartHistory');
    return history ? JSON.parse(history) : [];
  }
  function saveHistory(history) {
    localStorage.setItem('birthChartHistory', JSON.stringify(history));
  }
  function generateKey(name, day, month, year, gender) {
    return name.trim().toLowerCase() + "_" + day + "_" + month + "_" + year + "_" + gender;
  }
  // Save a record including the Name Number to localStorage
  function saveToLocalStorage(name, day, month, year, gender, driver, conductor, kuva, nameNumber, grid) {
    const history = loadHistory();
    const key = generateKey(name, day, month, year, gender);
    const entry = { key, name, day, month, year, gender, driver, conductor, kuva, nameNumber, grid };
    const index = history.findIndex(rec => rec.key === key);
    if (index !== -1) {
      history[index] = entry;
    } else {
      history.push(entry);
    }
    saveHistory(history);
    renderHistory();
  }
  
  function extractNumbersFromGrid(grid) {
    return grid.flat(2);
  }
  
  // Updated renderGrid: Displays each expected number based on frequency from computed grid.
  // If a number exists, show it repeated the number of times it occurs.
  // If missing, show strike-through of the number in a smaller font.
  function renderGrid(grid) {
  const birthDigits = extractNumbersFromGrid(grid);
  const greenRequired = [4, 5, 6];
  const blueRequired = [2, 5, 8];

  // Standard 3├Ч3 Loshu arrangement:
  //   4  9  2
  //   3  5  7
  //   8  1  6
  const cellMap = [
    [4, 9, 2],
    [3, 5, 7],
    [8, 1, 6]
  ];
  
  loshuGridDiv.innerHTML = '';
  
  cellMap.forEach(row => {
    row.forEach(expectedDigit => {
      const cellDiv = document.createElement('div');
      cellDiv.className = 'loshu-cell';
      
      // Count how many times the expected digit is present
      const count = birthDigits.filter(num => num === expectedDigit).length;
      let displayContent = "";
      if (count > 0) {
        displayContent = Array(count).fill(expectedDigit).join(' ') + ' <span class="zoom d-none">ЁЯФН</span>';
      } else {
        displayContent = `<s  class="text-danger">${expectedDigit}</s> <span class="zoom d-none">ЁЯФН</span>`;
      }
      cellDiv.setAttribute('data-bs-toggle', 'tooltip');
      cellDiv.setAttribute('title', 'Click to view details');

      cellDiv.innerHTML = displayContent;
      
      // Set tooltip title using static mapping
      const tooltipTitles = {
        4: "Rahu - рк░рк╛рк╣рлБ",
        9: "Mars - ркоркВркЧрк│",
        2: "Moon - ркЪркВркжрлНрк░",
        3: "Jupiter - ркЧрлБрк░рлБ",
        5: "Mercury - ркмрлБркз",
        7: "Ketu - ркХрлЗрддреБ",
        8: "Saturn - рк╢ркирк┐",
        1: "Sun - рк╕рлВрк░рлНркп",
        6: "Venus - рк╢рлБркХрлНрк░"
      };
      cellDiv.title = tooltipTitles[expectedDigit];
      
      // Highlight cell if ALL numbers from a set are present in this cell (optional)
      if (greenRequired.every(num => birthDigits.includes(num)) && greenRequired.includes(expectedDigit)) {
        cellDiv.classList.add('bg-success', 'text-white');
      } else if (blueRequired.every(num => birthDigits.includes(num)) && blueRequired.includes(expectedDigit)) {
        cellDiv.classList.add('bg-primary', 'text-white');
      }
      
      // Add click event to trigger detail popup for this expected digit
      cellDiv.addEventListener('click', function() {
        showPopup(expectedDigit);
      });
      
      loshuGridDiv.appendChild(cellDiv);
    });
  });

  initTolltip();
}

  
  // Render search history in descending order (most recent first)
  function renderHistory() {
    const history = loadHistory();
    historyListDiv.innerHTML = '';
    if (history.length === 0) {
      historyListDiv.textContent = "No search history yet.";
      return;
    }
    const sortedHistory = history.slice().reverse();
    const listGroup = document.createElement('div');
    listGroup.className = 'list-group';
    sortedHistory.forEach(record => {
      const item = document.createElement('button');
      item.type = 'button';
      item.className = 'list-group-item list-group-item-action';
      item.textContent = `${record.name} - ${record.day}/${record.month}/${record.year} (${record.gender})`;
      item.addEventListener('click', () => {
        loadRecord(record);
      });
      listGroup.appendChild(item);
    });
    historyListDiv.appendChild(listGroup);
  }
  
  // Load a record from history into the form and display its values
  function loadRecord(record) {
    document.getElementById('name').value = record.name;
    document.getElementById('day').value = record.day;
    document.getElementById('month').value = record.month;
    document.getElementById('year').value = record.year;
    if(record.gender === 'male') {
      document.getElementById('male').checked = true;
    } else {
      document.getElementById('female').checked = true;
    }
    renderGrid(record.grid);
    driverLabel.textContent = record.driver;
    conductorLabel.textContent = record.conductor;
    kuvaLabel.textContent = record.kuva;
    document.getElementById('nameNumberLabel').textContent = record.nameNumber;
  }
  
  birthForm.addEventListener('submit', (e) => {
    e.preventDefault();
    const nameValue = document.getElementById('name').value.trim();
    const dayValue = parseInt(document.getElementById('day').value, 10);
    const monthValue = parseInt(document.getElementById('month').value, 10);
    const yearValue = parseInt(document.getElementById('year').value, 10);
    const gender = document.querySelector('input[name="gender"]:checked').value;
    if (!nameValue || !dayValue || !monthValue || !yearValue || !gender) {
      alert('Please enter Name, select Day, Month, Year, and Gender.');
      return;
    }
    const dayString = dayValue < 10 ? '0' + dayValue : '' + dayValue;
    const monthString = monthValue < 10 ? '0' + monthValue : '' + monthValue;
    const yearString = '' + yearValue;
    const combined = dayString + monthString + yearString;
    
    // Prepare a 3x3 grid array for the Loshu grid
    const loshuGrid = Array.from({ length: 3 }, () =>
      Array.from({ length: 3 }, () => [])
    );
    combined.split('').forEach((char) => {
      const digit = parseInt(char, 10);
      if (digit !== 0 && positionMap[digit]) {
        const [row, col] = positionMap[digit];
        loshuGrid[row][col].push(digit);
      }
    });
    
    const driver = digitalRoot(dayValue);
    const sumDigits = combined.split('').reduce((sum, digit) => sum + parseInt(digit, 10), 0);
    const conductor = digitalRoot(sumDigits);
    const yearDigital = digitalRoot(yearValue);
    let kuvaCalc;
    if (gender === 'male') {
      kuvaCalc = digitalRoot(11 - yearDigital);
    } else {
      kuvaCalc = digitalRoot(yearDigital + 4);
    }
    
    // Process computed values into the grid
    const computedValues = [driver, conductor, kuvaCalc];
    computedValues.forEach(value => {
      value.toString().split('').forEach(char => {
        const digit = parseInt(char, 10);
        if (digit !== 0 && positionMap[digit]) {
          const [row, col] = positionMap[digit];
          loshuGrid[row][col].push(digit);
        }
      });
    });
    
    // Compute the Name Number from the input name
    const nameNumber = computeNameNumber(nameValue);
    
    renderGrid(loshuGrid);
    driverLabel.textContent = driver;
    conductorLabel.textContent = conductor;
    kuvaLabel.textContent = kuvaCalc;
    document.getElementById('nameNumberLabel').textContent = nameNumber;
    
    // Save record (including nameNumber) to localStorage
    saveToLocalStorage(nameValue, dayValue, monthValue, yearValue, gender, driver, conductor, kuvaCalc, nameNumber, loshuGrid);
  });

  document.querySelector('a[href="#historyContainer"]').addEventListener('click', function (e) {
  const target = document.getElementById('historyContainer');
  
  // Add the highlight class
  target.classList.add('highlight-section');

  // Remove the class after 2 seconds
  setTimeout(() => {
    target.classList.remove('highlight-section');
  }, 2000);
});

</script>
</body>
</html>
